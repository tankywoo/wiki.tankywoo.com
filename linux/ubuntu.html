<!DOCTYPE HTML>
<html>
    <head>
        <link rel="Stylesheet" type="text/css" href="/static/css/colorful.css">
        <link rel="Stylesheet" type="text/css" href="/static/css/style.css">
        <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
        <link rel="icon" href="/favicon.ico" type="image/x-icon">
        <link rel="alternate" type="application/atom+xml" href="atom.xml" title="Atom feed">
        <title>Ubuntu - Wiki · Tanky Woo</title>
        <meta name="keywords" content="wiki, makrdown, linux, python, cpp, ops, simiki"/>
        <meta name="description" content="Tanky Woo's personal wiki, powered by vim and markdown. Focus on Python, C/C++, Linux, Ops-Dev, Gentoo, and so on."/>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        

    </head>

    <body>
        <div id="container" class="typo">
            
    <div id="header">
        <div id="post-nav">
            
            <a href="/">Wiki · Tanky Woo</a> » <a href="/#linux">linux</a> » Ubuntu
            
        </div>
    </div>
    <div class="clearfix"></div>
    <div id="content">
        <div class="toc"><span class="toctitle">Table of Contents</span><ul>
<li><a href="#_1">经验</a><ul>
<li><a href="#remove-vs-purge">remove vs purge</a></li>
<li><a href="#_2">查询指定包的反向依赖</a></li>
</ul>
</li>
<li><a href="#_3">问题</a></li>
<li><a href="#syntax-error-unknown-group-ssl-cert-in-statoverride-file">syntax error: unknown group 'ssl-cert' in statoverride file</a></li>
</ul>
</div>
<p><img alt="Ubuntu Logo" src="http://design.ubuntu.com/wp-content/uploads/ubuntu-orange.gif" /></p>
<ul>
<li><a href="http://www.ubuntu.com/server">Ubuntu官网</a></li>
<li><a href="https://help.ubuntu.com/">Ubuntu Help</a></li>
</ul>
<h2 id="_1">经验</h2>
<h3 id="remove-vs-purge">remove vs purge</h3>
<p><code>apt-get</code> 的 <code>remove</code> 和 <code>purge</code> 区别:</p>
<ul>
<li><code>remove</code>: 只删除软件包, 保留配置文件</li>
<li><code>purge</code>: 删除软件包和配置文件</li>
</ul>
<p>这里的配置文件是指包添加的系统配置, 不包括用户自定义的配置.</p>
<p>参考:</p>
<ul>
<li>man apt-get</li>
<li><a href="http://askubuntu.com/questions/231562/what-is-the-difference-between-apt-get-purge-and-apt-get-remove">What is the Difference Between <code>apt-get purge</code> and <code>apt-get remove</code>?</a></li>
<li><a href="http://askubuntu.com/questions/187888/what-is-the-correct-way-to-completely-remove-an-application">What is the correct way to completely remove an application?</a></li>
</ul>
<h3 id="_2">查询指定包的反向依赖</h3>
<p>即查看哪些包依赖指定的包.</p>
<div class="hlcode"><pre><span class="nx">apt</span><span class="na">-cache</span> <span class="nx">rdepends</span> <span class="o">&lt;</span><span class="nx">package</span><span class="o">&gt;</span>
</pre></div>


<p>showpkg也可以, 不过包含的内容更多一些:</p>
<div class="hlcode"><pre><span class="nx">apt</span><span class="na">-cache</span> <span class="nx">showpkg</span> <span class="o">&lt;</span><span class="nx">package</span><span class="o">&gt;</span>
</pre></div>


<p>查看哪些<strong>已安装</strong>的包依赖指定的包:</p>
<div class="hlcode"><pre><span class="nx">apt</span><span class="na">-cache</span> <span class="nx">rdepends</span> <span class="o">--</span><span class="nx">installed</span> <span class="o">&lt;</span><span class="nx">package</span><span class="o">&gt;</span>
</pre></div>


<p>更多可以<code>man 8 apt-cache</code></p>
<p>参考:</p>
<ul>
<li><a href="http://askubuntu.com/questions/128524/how-to-list-dependent-packages-reverse-dependencies">How to list dependent packages</a></li>
<li><a href="http://askubuntu.com/questions/5636/can-i-see-why-a-package-is-installed">Can I see why a package is installed?</a></li>
</ul>
<h2 id="_3">问题</h2>
<h2 id="syntax-error-unknown-group-ssl-cert-in-statoverride-file">syntax error: unknown group 'ssl-cert' in statoverride file</h2>
<p>安装某个包时遇到这个报错:</p>
<div class="hlcode"><pre><span class="err">$</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">libffi</span><span class="o">-</span><span class="n">dev</span>
<span class="n">Reading</span> <span class="n">package</span> <span class="n">lists</span><span class="p">...</span> <span class="n">Done</span>
<span class="n">Building</span> <span class="n">dependency</span> <span class="n">tree</span>
<span class="n">Reading</span> <span class="n">state</span> <span class="n">information</span><span class="p">...</span> <span class="n">Done</span>
<span class="n">The</span> <span class="n">following</span> <span class="n">NEW</span> <span class="n">packages</span> <span class="n">will</span> <span class="n">be</span> <span class="n">installed</span><span class="o">:</span>
  <span class="n">libffi</span><span class="o">-</span><span class="n">dev</span>
<span class="mi">0</span> <span class="n">upgraded</span><span class="p">,</span> <span class="mi">1</span> <span class="n">newly</span> <span class="n">installed</span><span class="p">,</span> <span class="mi">0</span> <span class="n">to</span> <span class="n">remove</span> <span class="n">and</span> <span class="mi">18</span> <span class="n">not</span> <span class="n">upgraded</span><span class="p">.</span>
<span class="n">Need</span> <span class="n">to</span> <span class="n">get</span> <span class="mi">0</span> <span class="n">B</span><span class="o">/</span><span class="mf">96.1</span> <span class="n">kB</span> <span class="n">of</span> <span class="n">archives</span><span class="p">.</span>
<span class="n">After</span> <span class="n">this</span> <span class="n">operation</span><span class="p">,</span> <span class="mi">356</span> <span class="n">kB</span> <span class="n">of</span> <span class="n">additional</span> <span class="n">disk</span> <span class="n">space</span> <span class="n">will</span> <span class="n">be</span> <span class="n">used</span><span class="p">.</span>
<span class="nl">dpkg:</span> <span class="n">unrecoverable</span> <span class="n">fatal</span> <span class="n">error</span><span class="p">,</span> <span class="n">aborting</span><span class="o">:</span>
 <span class="n">syntax</span> <span class="n">error</span><span class="o">:</span> <span class="n">unknown</span> <span class="n">group</span> <span class="err">&#39;</span><span class="n">ssl</span><span class="o">-</span><span class="n">cert</span><span class="err">&#39;</span> <span class="n">in</span> <span class="n">statoverride</span> <span class="n">file</span>
<span class="nl">E:</span> <span class="n">Sub</span><span class="o">-</span><span class="n">process</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">dpkg</span> <span class="n">returned</span> <span class="n">an</span> <span class="n">error</span> <span class="n">code</span> <span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>


<p>其实提示还是很清楚了, statoverride文件有一个未知的用户组ssl-cert.</p>
<p>这个组其实是Apache建立的. 个人猜测应该是在卸载Apache时, 用的remove而不是purge导致.</p>
<p>文件在/var/lib/dpkg/statoverride:</p>
<div class="hlcode"><pre><span class="err">$</span> <span class="n">cat</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">dpkg</span><span class="o">/</span><span class="n">statoverride</span>
<span class="n">root</span> <span class="n">mlocate</span> <span class="mi">2755</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">mlocate</span>
<span class="n">root</span> <span class="n">ssl</span><span class="o">-</span><span class="n">cert</span> <span class="mi">710</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">ssl</span><span class="o">/</span><span class="n">private</span>
<span class="n">root</span> <span class="n">Debian</span><span class="o">-</span><span class="n">exim</span> <span class="mi">640</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">exim4</span><span class="o">/</span><span class="n">passwd</span><span class="p">.</span><span class="n">client</span>
<span class="n">root</span> <span class="n">stapusr</span> <span class="mi">4750</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">staprun</span>
<span class="n">root</span> <span class="n">crontab</span> <span class="mi">2755</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">crontab</span>
</pre></div>


<p>这个的作用可以<a href="http://manpages.ubuntu.com/manpages/trusty/man8/dpkg-statoverride.8.html"><code>man 8 dpkg-statoverride</code></a>:</p>
<blockquote>
<p>override ownership and mode of files</p>
<p>`stat overrides' are a way to tell dpkg(1) to use a different owner or mode for a path when a package is installed</p>
</blockquote>
    </div>

        </div>
        <div id="footer">
              <p>
                Copyright © 2012-2016 Tanky Woo.
                Powered by <a href="http://simiki.org/" target="_blank">Simiki</a>.
                Theme by <a href="https://github.com/tankywoo/yasimple" target="_blank">YASimple</a>.
              </p>
                <p>Last Update 2016-02-06 23:06:00</p>
                <p><a href="https://github.com/tankywoo/wiki.tankywoo.com">Fork me on Github</a></p>
        </div>
<script type="text/javascript">
	var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
	document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3F754de327571c0ba7ff50a61fc964e196' type='text/javascript'%3E%3C/script%3E"));
</script>
    </body>
</html>